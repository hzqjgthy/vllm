from vllm import LLM, SamplingParams

llm = LLM(
    model="/root/autodl-tmp/vllm/deepseek-ai/DeepSeek-R1-Distill-Qwen-1___5B",
    trust_remote_code=True,
    max_model_len=4096,
    gpu_memory_utilization=0.5,
)

# ✅ 强制模型以 <think>\n  结尾，确保输出思考过程；同样输出结果也是 </think> 前为思考过程，后为真正回答
prompts = "给我规划一个北京的三天游玩路线<think>\n"

sampling_params = SamplingParams(
    temperature=0.7,
    top_p=0.9,
    max_tokens=4096,
    skip_special_tokens=True,
)

print("\n" + "="*50)
print("开始推理测试...")
print("="*50 + "\n")

outputs = llm.generate(prompts, sampling_params=sampling_params)

for output in outputs:
    prompt = output.prompt
    generated_text = output.outputs[0].text
    print(f"提示词: {prompt}")
    print(f"生成结果: {generated_text}")
    print(f"生成 tokens 数: {len(output.outputs[0].token_ids)}")
    print(f"结束原因: {output.outputs[0].finish_reason}")
    print("-" * 50)


"""生成结果为：


好的，我现在要帮用户规划北京的三天游玩路线。用户可能已经有一定的了解，但可能不太清楚如何组织行程。我得先理清楚北京的景点分布，然后考虑如何安排三天，让每个景点都有时间去，同时保持行程紧凑。

首先，第一天可以考虑主要的景点，比如天安门、故宫、北京博物馆和石景山。这些地方都是必去的，但可能有些地方时间不够。比如，天安门和故宫可能需要两个上午，这样第一天只能安排两个景点，剩下时间可能不够去其他景点。所以，可能需要调整，让第一天只安排两个主要景点，然后第二天安排其他景点，第三天在晚上或下午安排一些特色活动。

第二天可以安排一些历史和文化景点，比如北京图书馆、北海公园、北海道街和 hopefully的天安门广场。这样第二天有四个景点，时间也比较充分，安排在下午。

第三天可以考虑体验和夜生活，比如天安门广场、石景山公园、人民公园和 hopefully的北门。这样第三天安排三个景点，时间也比较充足。

另外，用户可能对北京的夜景感兴趣，比如夜游石景山，所以第三天安排夜游可能不错。同时，用户可能喜欢一些特色活动，比如摩天轮、飞天或者冰激凌，这些可以在第三天安排。

我还需要考虑交通时间，从第一天到第二天到第三天，每天的活动安排是否合理，有没有必要在某些景点停留，比如石景山可能不需要，因为时间有限。

另外，用户可能对某些景点不太熟悉，比如石景山的主景和景树，或者天安门的安排，所以需要提前了解这些细节，确保行程安排合理。

最后，可能需要提醒用户根据自己的时间安排和兴趣调整行程，或者提前准备一些小贴士，比如提前预订门票，或者带一些小礼物。

总的来说，我需要确保三天行程安排紧凑，每个景点都有时间去，同时考虑交通时间和景点深度，让用户能够满意。
</think>

好的，以下是为北京游客规划的三天游玩路线，力求紧凑且有趣：

---

### **第一天：游览必见景点**
**上午：**
1. **天安门广场**  
   - 体验北京的繁华，感受历史和现代的结合。  
   - 乘坐小汽车游览天安门上的长城，了解历史。  
   - 参观天安门上空的烟花表演（建议提前购买门票）。  

2. **故宫博物院**  
   - 了解中国古代的历史，参观藏经洞和藏经洞外的文物。  

3. **北京博物馆**  
   - 感受中华文化的博大精深，了解历史和艺术。  

**下午：**
4. **石景山公园**  
   - 游览石景山的主景，欣赏钟楼、大钟和松树林。  
   - 参观石景山的景树，感受古树的高大和光影。  

5. **北海公园**  
   - 了解北海道街的历史，感受历史文化与现代生活的结合。  

6. **人民公园**  
   - 游览人民公园的花坛、小径和雕塑，感受北京的慢生活。  

**晚上：**
7. **北门广场**  
   - 体验北京的夜生活，漫步北门广场，感受灯光秀和夜景。  

---

### **第二天：历史与文化景点**
**上午：**
8. **北京图书馆**  
   - 了解中国古代的科技和文化，参观藏书丰富的藏经洞。  

9. **北海道街**  
   - 驱车游览北海道街，感受历史与现代的结合。  

**下午：**
10. **天安门广场**  
    - 暗想天安门广场的夜景，感受北京的繁华。  

11. **北京 zoo**  
    - 了解生物和植物的奇观，感受自然与人文的结合。  

12. **故宫博物院（下午）**  
    - 指导学生参观故宫，了解历史与艺术的结合。  

**晚上：**
13. **石景山公园**  
    - 晚上可以在石景山公园观看夜景表演（如“东方有你”表演）。  

---

### **第三天：夜游与体验**
**上午：**
14. **天安门广场**  
    - 晚上在天安门广场，可以体验“夜游”（如“夜看天安门”）或购买夜景套票。  

**下午：**
15. **石景山公园**  
    - 石景山公园的夜景非常美丽，可以夜游欣赏夜景。  

16. **人民公园**  
    - 晚上在人民公园，可以参加“冰激凌大 party”或体验其他特色活动。  

**晚上：**
17. **北门广场**  
    - 跟随 guide，体验北门广场的夜生活，感受传统与现代的结合。  

---

### **小贴士：**
- **交通时间：**  
  - 从第一天到第二天，建议早晨或下午从北京出发，确保行程紧凑。  
  - 第二天可以早起去石景山，下午前往北门广场。  

- **门票：**  
  - 多提前查看门票，避免排队。  
  - 北京的夜景和文化活动可能需要提前预订门票。  

- **特色活动：**  
  - 如果你喜欢“摩天轮”或“飞天”，可以在第三天安排。  
  - 如果喜欢“冰激凌”，可以在北门广场的夜景或夜游时尝试。  

希望这份路线能让你的三天游充满惊喜！如果有其他需求，欢迎随时提出！


"""